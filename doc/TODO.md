TODO:

现存问题:

5.问题:处理玩家账号登陆后,挤掉之前的登陆,考虑同网关服,不同网关服登陆情况.


优化点:

1.持续优化现有的业务线程模型(暂时实现了为每一个id分配一个单线程池的做法)
方案1:
维护一个总的消息队列,所有玩家的消息都放入这个队列,但是同一个玩家的消息总是由一个相同的线程去执行,根据玩家id取模线程池大小即可,
在单线程执行时，所有的消息只能一个一个接着来了.但是这样手气不好的时候,有可能有的线程会很累,有的线程会很闲,但侵入性低(现在的模型).
方案2:
凡是需要处理客户端消息的对象，都需要维护一个消息队列.例如每个玩家都维护一个消息队列,任何一个玩家的消息队列有数据时,
都会notify通知线程池的任意线程wakeUp去处理消息,单个线程一次处理完队列里所有的消息(侵入性高,效率未知,理论上是最高的).
方案3:
维护一个总的消息队列,所有玩家的消息都放入这个队列,有任何玩家消息来的时候,消息和玩家的session绑定放入这个队列,
线程池中的任意线程得到消息执行时,先试着对这个session加锁（session里维护一个volatile的是否锁定状态标志）,
如果session已是锁定状态,说明有线程正在处理这个玩家的协议,那么这个玩家新来的消息将放在消息队列后面,
否则认为没有线程正在处理该玩家的消息,该线程立即处理该玩家的消息.
而传统的线程池是不支持这样的,因此这种方案还需自定义线程池实现.

6.增加以Redis作为持久化方式的类CacheService对象,让业务层不需要自主去调用相关读写方法,跟MySQL使用方式类似,隐藏数据持久层细节

7.增加Json文件解析器,且不需要以类名作为Json文件名称

9.新增监控模块,用于后续的性能优化.选型SkyWalking,主要解决分布式链路追踪,应用级别性能监控,低侵入

10.FileBeats收集埋点日志,Logstash日志收集过滤工具,ELK日志分布式搜索工具,Kibana可视化日志Web层展示工具

11.分布式事务

待实现通用业务模块:

2.MMO战斗模块,单人,多人同场景对战--https://zhuanlan.zhihu.com/p/148077453

3.定时器模块

4.账号模块

5.条件判断模块

6.资源,背包模块

7.任务模块

8.排行榜模块
